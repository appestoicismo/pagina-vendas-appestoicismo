<!DOCTYPE html>
<html lang="pt-BR">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Quiz AppAutoconhecimento - Está Pronto Para Olhar Para o Lugar Certo?</title>
   
   <!-- Facebook Pixel Code -->
   <script>
       !function(f,b,e,v,n,t,s)
       {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
       n.callMethod.apply(n,arguments):n.queue.push(arguments)};
       if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
       n.queue=[];t=b.createElement(e);t.async=!0;
       t.src=v;s=b.getElementsByTagName(e)[0];
       s.parentNode.insertBefore(t,s)}(window, document,'script',
       'https://connect.facebook.net/en_US/fbevents.js');
       fbq('init', '706101819074980');
       fbq('track', 'PageView');
   </script>
   <noscript><img height="1" width="1" style="display:none"
       src="https://www.facebook.com/tr?id=706101819074980&ev=PageView&noscript=1"
   /></noscript>
   <!-- End Facebook Pixel Code -->

   <style>
       :root {
           --cor-principal: #0f172a;
           --cor-destaque: #22c55e;
           --cor-urgente: #ef4444;
           --cor-texto: #ffffff;
           --cor-secundaria: #1e293b;
           --cor-hover: #16a34a;
           --cor-dourado: #fbbf24;
       }

       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }

       html {
           scroll-behavior: smooth;
       }

       body {
           font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
           background: linear-gradient(135deg, var(--cor-principal) 0%, var(--cor-secundaria) 100%);
           color: var(--cor-texto);
           min-height: 100vh;
           line-height: 1.6;
       }

       .container {
           max-width: 600px;
           margin: 0 auto;
           padding: 20px;
           min-height: 100vh;
           display: flex;
           flex-direction: column;
           justify-content: center;
       }

       /* ANIMAÇÕES SUAVES */
       .screen-transition {
           animation: fadeInUp 0.6s ease-out;
       }

       @keyframes fadeInUp {
           from { 
               opacity: 0; 
               transform: translateY(30px); 
           }
           to { 
               opacity: 1; 
               transform: translateY(0); 
           }
       }

       /* ELEMENTOS DE UI CLAROS */
       .clickable-button {
           cursor: pointer;
           transition: all 0.3s ease;
           position: relative;
           overflow: hidden;
       }

       .clickable-button:hover {
           transform: translateY(-3px);
       }

       .clickable-button:active {
           transform: translateY(-1px);
       }

       .non-clickable {
           cursor: default !important;
           pointer-events: none;
       }

       .quiz-header {
           text-align: center;
           margin-bottom: 20px;
       }

       .quiz-header h1 {
           font-size: 2.2rem;
           font-weight: 700;
           margin-bottom: 10px;
           background: linear-gradient(45deg, var(--cor-destaque), #34d399);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
       }

       .quiz-header p {
           font-size: 1.1rem;
           opacity: 0.9;
           margin-bottom: 20px;
       }

       .progress-container {
           background: rgba(255, 255, 255, 0.1);
           border-radius: 10px;
           padding: 10px;
           margin-bottom: 30px;
       }

       .progress-bar {
           background: linear-gradient(90deg, var(--cor-destaque), #34d399);
           height: 8px;
           border-radius: 4px;
           transition: width 0.8s ease;
           width: 0%;
       }

       .progress-text {
           text-align: center;
           margin-top: 8px;
           font-size: 0.9rem;
           opacity: 0.8;
       }

       .question-container {
           background: rgba(255, 255, 255, 0.05);
           border-radius: 15px;
           padding: 30px;
           margin-bottom: 20px;
           border: 1px solid rgba(255, 255, 255, 0.1);
           backdrop-filter: blur(10px);
           animation: slideIn 0.5s ease-out;
       }

       @keyframes slideIn {
           from { transform: translateX(20px); opacity: 0; }
           to { transform: translateX(0); opacity: 1; }
       }

       .question-number {
           color: var(--cor-destaque);
           font-size: 0.9rem;
           font-weight: 600;
           margin-bottom: 10px;
       }

       .question-title {
           font-size: 1.4rem;
           font-weight: 600;
           margin-bottom: 25px;
           line-height: 1.4;
       }

       .question-objective {
           font-size: 0.9rem;
           opacity: 0.7;
           font-style: italic;
           margin-bottom: 20px;
           color: #94a3b8;
       }

       .answer-option {
           background: rgba(255, 255, 255, 0.08);
           border: 2px solid rgba(255, 255, 255, 0.1);
           border-radius: 12px;
           padding: 18px 20px;
           margin-bottom: 12px;
           cursor: pointer;
           transition: all 0.3s ease;
           position: relative;
           overflow: hidden;
           min-height: 60px;
           display: flex;
           align-items: center;
       }

       .answer-option:hover {
           background: rgba(34, 197, 94, 0.1);
           border-color: var(--cor-destaque);
           transform: translateY(-2px);
           box-shadow: 0 5px 15px rgba(34, 197, 94, 0.2);
       }

       .answer-option.selected {
           background: var(--cor-destaque);
           border-color: var(--cor-destaque);
           color: var(--cor-principal);
           font-weight: 600;
           transform: scale(1.02);
           box-shadow: 0 8px 20px rgba(34, 197, 94, 0.3);
       }

       .btn-next {
           background: linear-gradient(45deg, var(--cor-destaque), #34d399);
           color: var(--cor-principal);
           border: none;
           padding: 18px 40px;
           border-radius: 25px;
           font-size: 1.1rem;
           font-weight: 600;
           cursor: pointer;
           transition: all 0.3s ease;
           width: 100%;
           margin-top: 20px;
           opacity: 0.5;
           pointer-events: none;
           min-height: 55px;
           display: flex;
           align-items: center;
           justify-content: center;
       }

       .btn-next.active {
           opacity: 1;
           pointer-events: all;
       }

       .btn-next.active:hover {
           transform: translateY(-3px);
           box-shadow: 0 10px 25px rgba(34, 197, 94, 0.3);
       }

       .start-screen {
           text-align: center;
       }

       .start-screen h2 {
           font-size: 2rem;
           margin-bottom: 20px;
           color: var(--cor-destaque);
       }

       .start-screen p {
           font-size: 1.1rem;
           margin-bottom: 30px;
           opacity: 0.9;
       }

       .btn-start {
           background: linear-gradient(45deg, var(--cor-destaque), #34d399);
           color: var(--cor-principal);
           border: none;
           padding: 20px 50px;
           border-radius: 30px;
           font-size: 1.2rem;
           font-weight: 700;
           cursor: pointer;
           transition: all 0.3s ease;
           min-height: 60px;
           display: inline-flex;
           align-items: center;
           justify-content: center;
           text-decoration: none;
       }

       .btn-start:hover {
           transform: translateY(-3px);
           box-shadow: 0 15px 30px rgba(34, 197, 94, 0.4);
       }

       .result-screen {
           text-align: center;
           display: none;
       }

       .result-screen h2 {
           font-size: 2.2rem;
           margin-bottom: 25px;
           color: var(--cor-destaque);
       }

       .result-content {
           background: rgba(255, 255, 255, 0.05);
           border-radius: 15px;
           padding: 30px;
           margin-bottom: 30px;
           border: 1px solid rgba(255, 255, 255, 0.1);
       }

       /* PÁGINA DE RESULTADO FOCADA EM ATIVAÇÃO GRATUITA */
       .activation-page {
           max-width: 800px;
           margin: 0 auto;
           padding: 20px;
       }

       .page-header {
           text-align: center;
           margin-bottom: 40px;
           padding: 30px 20px;
           background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(251, 191, 36, 0.1) 100%);
           border-radius: 20px;
           border: 1px solid rgba(34, 197, 94, 0.3);
       }

       .page-header h1 {
           font-size: 2.5rem;
           font-weight: 800;
           margin-bottom: 20px;
           background: linear-gradient(45deg, var(--cor-destaque), var(--cor-dourado));
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           line-height: 1.2;
       }

       .page-header .subtitle {
           font-size: 1.3rem;
           color: var(--cor-dourado);
           font-weight: 600;
           margin-bottom: 25px;
       }

       .free-access-highlight {
           background: linear-gradient(90deg, var(--cor-destaque), var(--cor-dourado));
           color: var(--cor-principal);
           padding: 20px;
           border-radius: 12px;
           margin: 25px 0;
           text-align: center;
           font-weight: 700;
           font-size: 1.4rem;
       }

       .benefit-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
           gap: 20px;
           margin: 30px 0;
       }

       .benefit-card {
           background: rgba(34, 197, 94, 0.1);
           border-radius: 15px;
           padding: 25px;
           border: 1px solid rgba(34, 197, 94, 0.3);
           text-align: center;
       }

       .benefit-card .icon {
           font-size: 2.5rem;
           margin-bottom: 15px;
           display: block;
       }

       .benefit-card h4 {
           color: var(--cor-destaque);
           margin-bottom: 15px;
           font-size: 1.2rem;
       }

       .benefit-card p {
           font-size: 1rem;
           line-height: 1.5;
           opacity: 0.9;
       }

       .cta-section {
           background: rgba(255, 255, 255, 0.05);
           border-radius: 15px;
           padding: 30px;
           margin: 30px 0;
           border: 1px solid rgba(255, 255, 255, 0.1);
           text-align: center;
       }

       .cta-main {
           background: linear-gradient(45deg, var(--cor-destaque), #34d399);
           color: var(--cor-principal);
           border: none;
           padding: 25px 50px;
           border-radius: 30px;
           font-size: 1.3rem;
           font-weight: 700;
           cursor: pointer;
           transition: all 0.3s ease;
           margin: 20px 0;
           text-decoration: none;
           display: inline-block;
           min-width: 300px;
       }

       .cta-main:hover {
           transform: translateY(-3px);
           box-shadow: 0 15px 35px rgba(34, 197, 94, 0.5);
       }

       .guarantee-note {
           background: rgba(34, 197, 94, 0.1);
           border: 1px solid var(--cor-destaque);
           border-radius: 12px;
           padding: 20px;
           margin: 20px 0;
           font-size: 1.1rem;
           font-weight: 500;
       }

       .urgency-timer {
           background: rgba(239, 68, 68, 0.1);
           border: 2px solid var(--cor-urgente);
           border-radius: 15px;
           padding: 20px;
           margin: 25px 0;
           text-align: center;
       }

       .timer-display {
           font-size: 2rem;
           font-weight: 700;
           color: var(--cor-urgente);
           margin: 10px 0;
       }

       /* TELA DE ACOLHIMENTO */
       .compassion-screen {
           text-align: center;
           padding: 30px;
           background: rgba(255, 255, 255, 0.05);
           border-radius: 15px;
           border: 1px solid rgba(255, 255, 255, 0.1);
       }

       .compassion-screen h2 {
           color: var(--cor-destaque);
           font-size: 2rem;
           margin-bottom: 20px;
       }

       .compassion-screen p {
           color: #ccc;
           max-width: 600px;
           margin: 16px auto;
           font-size: 1.1rem;
           line-height: 1.6;
       }

       .audio-player {
           margin: 30px auto;
           display: block;
           width: 100%;
           max-width: 400px;
       }

       .btn-secondary {
           background: rgba(255, 255, 255, 0.1);
           color: var(--cor-texto);
           border: 1px solid rgba(255, 255, 255, 0.3);
           padding: 15px 30px;
           border-radius: 20px;
           font-size: 1rem;
           cursor: pointer;
           margin: 10px;
           transition: all 0.3s ease;
           min-height: 50px;
           display: inline-flex;
           align-items: center;
           justify-content: center;
           text-decoration: none;
       }

       .btn-secondary:hover {
           background: rgba(255, 255, 255, 0.2);
           transform: translateY(-2px);
       }

       .exit-screen {
           text-align: center;
           display: none;
           padding: 30px;
       }

       .exit-screen h2 {
           color: var(--cor-urgente);
           margin-bottom: 20px;
       }

       .btn-restart {
           background: linear-gradient(45deg, #6b7280, #9ca3af);
           color: white;
           border: none;
           padding: 15px 35px;
           border-radius: 25px;
           font-size: 1rem;
           font-weight: 600;
           cursor: pointer;
           margin-top: 20px;
           transition: all 0.3s ease;
           min-height: 50px;
       }

       .btn-restart:hover {
           transform: translateY(-2px);
           box-shadow: 0 8px 20px rgba(107, 114, 128, 0.3);
       }

       .loading-screen {
           display: none;
           text-align: center;
           flex-direction: column;
           justify-content: center;
           align-items: center;
       }

       .spinner {
           width: 50px;
           height: 50px;
           border: 4px solid rgba(255, 255, 255, 0.1);
           border-left: 4px solid var(--cor-destaque);
           border-radius: 50%;
           animation: spin 1s linear infinite;
           margin-bottom: 20px;
       }

       @keyframes spin {
           0% { transform: rotate(0deg); }
           100% { transform: rotate(360deg); }
       }

       .hidden {
           display: none !important;
       }

       /* LOADING STATES */
       .btn-loading {
           position: relative;
           color: transparent !important;
       }

       .btn-loading::after {
           content: '';
           position: absolute;
           width: 20px;
           height: 20px;
           top: 50%;
           left: 50%;
           margin-left: -10px;
           margin-top: -10px;
           border: 2px solid transparent;
           border-top-color: var(--cor-principal);
           border-radius: 50%;
           animation: spin 1s linear infinite;
       }

       /* RESPONSIVIDADE MOBILE */
       @media (max-width: 768px) {
           .container {
               padding: 15px;
           }
           
           .activation-page {
               padding: 15px;
           }
           
           .quiz-header h1 {
               font-size: 1.8rem;
           }
           
           .page-header h1 {
               font-size: 2rem;
           }
           
           .question-container {
               padding: 25px 20px;
           }
           
           .question-title {
               font-size: 1.2rem;
           }

           .answer-option {
               padding: 20px 18px;
               font-size: 1rem;
           }

           .btn-start, .btn-next, .cta-main {
               font-size: 1.1rem;
               padding: 18px 30px;
               min-width: auto;
           }

           .benefit-grid {
               grid-template-columns: 1fr;
               gap: 15px;
           }

           .timer-display {
               font-size: 1.5rem;
           }
       }

       @media (max-width: 480px) {
           .quiz-header h1 {
               font-size: 1.6rem;
           }

           .page-header h1 {
               font-size: 1.8rem;
           }

           .question-title {
               font-size: 1.1rem;
           }

           .answer-option {
               padding: 16px 15px;
               font-size: 0.95rem;
           }

           .cta-main {
               min-width: 250px;
           }
       }
   </style>
</head>
<body>
   <div class="container">
       <!-- Tela Inicial -->
       <div id="startScreen" class="start-screen screen-transition">
           <div class="quiz-header">
               <p style="font-size: 1.2rem; line-height: 1.6; margin-bottom: 25px; opacity: 0.95;">
                   🧠 O problema nunca foi o trabalho, o parceiro, o dinheiro ou a rotina. O problema é que você ainda não parou pra se conhecer…
               </p>
               <h2 style="font-size: 2.2rem; color: var(--cor-destaque); margin-bottom: 30px;">
                   💥 ESTÁ PRONTO PARA OLHAR PARA O LUGAR CERTO?
               </h2>
           </div>
           <button class="btn-start clickable-button" onclick="startQuiz()">🚀 ESTOU PRONTO</button>
       </div>

       <!-- Tela de Loading -->
       <div id="loadingScreen" class="loading-screen">
           <div class="spinner"></div>
           <h3>Analisando suas respostas...</h3>
           <p>Preparando seu acesso gratuito personalizado</p>
       </div>

       <!-- Quiz Principal -->
       <div id="quizScreen" class="hidden">
           <div class="quiz-header">
               <div class="progress-container">
                   <div class="progress-bar" id="progressBar"></div>
                   <div class="progress-text">
                       Pergunta <span id="currentQuestion">1</span> de 13
                   </div>
               </div>
           </div>

           <div class="question-container">
               <div class="question-number" id="questionNumber">PERGUNTA 1</div>
               <div class="question-title" id="questionTitle"></div>
               <div class="question-objective" id="questionObjective"></div>
               <div id="answersContainer"></div>
               <button class="btn-next clickable-button" id="nextBtn" onclick="nextQuestion()">Próxima Pergunta</button>
           </div>
       </div>

       <!-- Tela de Resultado - Ativação Gratuita -->
       <div id="activationScreen" class="result-screen">
           <!-- Conteúdo será inserido dinamicamente via JavaScript -->
       </div>

       <!-- Tela de Acolhimento -->
       <div id="compassionScreen" class="result-screen">
           <!-- Conteúdo será inserido dinamicamente via JavaScript -->
       </div>

       <!-- Tela de Saída -->
       <div id="exitScreen" class="exit-screen">
           <h2 id="exitTitle"></h2>
           <p id="exitMessage"></p>
           <button class="btn-restart clickable-button" id="restartBtn" onclick="restartQuiz()">🔄 Continuar Quiz</button>
       </div>
   </div>

   <script>
       // URL do Google Sheets - SUBSTITUA PELA SUA URL
       const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbwbQu0d-ABbX7xKzSTDyUcefjHCex7YiOJS3WvnPcBiUPDdhwN2aXrcdswfniM27VAW/exec';

       // Variáveis globais
       let stoppedAtQuestion = 0;
       let isSubmitting = false;
       let selectedTimePeriod = '';
       let urgencyDeadline = null;

       // CONFIGURAÇÃO DAS 13 PERGUNTAS
       const questions = [
           {
               number: 1,
               title: "Qual seu gênero?",
               objective: "",
               answers: ["👨 Homem", "👩 Mulher", "🤷 Prefiro não dizer"],
               exitAnswers: []
           },
           {
               number: 2,
               title: "Qual sua faixa etária?",
               objective: "",
               answers: ["🎓 18 a 24 anos", "💼 25 a 34 anos", "🏡 35 a 44 anos", "👔 45 a 54 anos", "🎖️ 55+"],
               exitAnswers: []
           },
           {
               number: 3,
               title: "Você sente que tem algo errado na sua vida... mas não sabe exatamente o quê?",
               answers: [
                   "🔍 Sim, parece que algo tá fora do lugar e eu não entendo",
                   "🤔 Já pensei nisso, mas nunca fui fundo",
                   "✅ Eu até sei o que está errado, mas estou com dificuldade para ajustar",
                   "❌ Não, tudo está sob controle"
               ],
               exitAnswers: [3],
               exitMessage: "Que bom que você sente que tem controle sobre sua vida! Talvez o AppAutoconhecimento não seja necessário para você neste momento."
           },
           {
               number: 4,
               title: "Você sente que está apenas vivendo os dias… sem saber se está indo pro lugar certo?",
               answers: [
                   "😐 Sim, como um barco à deriva",
                   "🌀 Às vezes, mas nem tenho tempo para pensar sobre isso",
                   "✅ Não, me sinto no caminho certo! Porém, falta estratégia"
               ],
               exitAnswers: []
           },
           {
               number: 5,
               title: "Você acredita que a falta de autoconhecimento… pode estar te afastando da vida que você deseja?",
               answers: [
                   "💥 Sim, acho que esse é o verdadeiro problema",
                   "🤷 Talvez, nunca tinha pensado nisso desse jeito",
                   "❌ Não, isso não tem nada a ver"
               ],
               exitAnswers: [2],
               exitMessage: "Entendemos sua perspectiva. O autoconhecimento pode não ser uma prioridade para você neste momento."
           },
           {
               number: 6,
               title: "Quantas decisões erradas você já tomou… por não saber o que realmente quer?",
               answers: [
                   "💸 Várias. E continuo repetindo algumas",
                   "🤔 Algumas, mas ainda busco entender",
                   "✅ Nenhuma. Sempre sei o que quero"
               ],
               exitAnswers: [2],
               exitMessage: "Impressionante! Você parece ter uma clareza excepcional sobre suas decisões. Talvez não precise do que oferecemos."
           },
           {
               number: 7,
               title: "Quando você precisa fazer escolhas, você:",
               objective: "",
               answers: [
                   "🎯 Decide com base nos seus 5 valores pessoais",
                   "⚡ Decide com base nas vantagens do momento",
                   "👥 Decide com base no que os outros desejam"
               ],
               exitAnswers: []
           },
           {
               number: 8,
               title: "Quando seu dia começa...",
               objective: "",
               answers: [
                   "❓ Não sei por onde começar",
                   "😔 Sei o que preciso fazer, mas não faço",
                   "🌊 Só acordo e deixo a vida me levar",
                   "🤖 Cumpro obrigações que nem escolhi de forma consciente"
               ],
               exitAnswers: []
           },
           {
               number: 9,
               title: "Se alguém te perguntar sobre seus pontos fortes e fracos, você...",
               objective: "",
               answers: [
                   "🤷 Eu não faço ideia do que responder",
                   "💭 Eu sinto quais são, mas ainda de forma inconsciente",
                   "✅ Eu sei exatamente no que sou muito bom e muito ruim"
               ],
               exitAnswers: [2],
               exitMessage: "Excelente! Você tem uma autopercepção muito desenvolvida. Talvez já tenha o autoconhecimento necessário."
           },
           {
               number: 10,
               title: "Quando a sua jornada nesse mundo estiver chegando ao fim... você quer olhar para trás e:",
               objective: "",
               answers: [
                   "🌟 Saber que viveu de forma autêntica",
                   "📜 Perceber que só seguiu um script que não foi você quem escreveu",
                   "🏆 Sentir que deixou um legado e fez a diferença",
                   "😰 Nem quero pensar sobre isso"
               ],
               exitAnswers: [3],
               exitMessage: "Entendemos que nem todos querem refletir sobre esses temas profundos. Tudo bem!"
           },
           {
               number: 11,
               title: "Escolha um período para se imaginar no futuro:",
               answers: [
                   "📅 Daqui 1 ano",
                   "📅 Daqui a 3 anos",
                   "📅 Daqui a 5 anos",
                   "📅 Daqui a 10 anos"
               ],
               exitAnswers: []
           },
           {
               number: 12,
               title: "", // Será preenchido dinamicamente
               objective: "",
               answers: [
                   "😴 Cansado e estagnado",
                   "😔 Arrependido de não ter começado hoje",
                   "🤖 Vivendo no automático",
                   "😊 Super feliz, pois minha vida está 'ok'"
               ],
               exitAnswers: [3],
               exitMessage: "Que ótimo que você se sente satisfeito com sua vida atual! Talvez não precise mudar nada mesmo."
           },
           {
               number: 13,
               title: "Você quer continuar vivendo sem saber quem você é... ou está pronto para mudar isso hoje?",
               answers: [
                   "🔥 Chega! Quero mudar isso AGORA",
                   "🤔 Quero mudar, mas preciso conhecer melhor esse método",
                   "😔 Prefiro deixar pra depois"
               ],
               exitAnswers: [],
               finalQuestion: true
           }
       ];

       let currentQuestionIndex = 0;
       let selectedAnswer = null;

       // FUNÇÕES PRINCIPAIS DO QUIZ
       function startQuiz() {
           hideAllScreens();
           document.getElementById('quizScreen').classList.remove('hidden');
           document.getElementById('quizScreen').classList.add('screen-transition');
           
          // Track Facebook event
fbq('track', 'Lead');
fbq('trackCustom', 'QuizStarted', {
   timestamp: new Date().toISOString()
});

showQuestion();
smartScrollToTop();
}

function showQuestion() {
   const question = questions[currentQuestionIndex];
   
   // Track pergunta específica
   fbq('trackCustom', 'QuestionViewed', {
       question_number: currentQuestionIndex + 1,
       question_text: question.title.substring(0, 50)
   });
   
   // Atualizar progresso com animação
   const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
   setTimeout(() => {
       document.getElementById('progressBar').style.width = progress + '%';
   }, 100);
   document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
   
   // Atualizar pergunta
   document.getElementById('questionNumber').textContent = `PERGUNTA ${question.number}`;
   
   // Pergunta 12 precisa ser personalizada com o período selecionado
   if (currentQuestionIndex === 11) {
       const periods = ['1 ano', '3 anos', '5 anos', '10 anos'];
       const selectedPeriod = periods[selectedTimePeriod] || '3 anos';
       document.getElementById('questionTitle').textContent = `Imagine-se daqui a ${selectedPeriod}. Se você não fizer nada para mudar… como acha que estará?`;
   } else {
       document.getElementById('questionTitle').textContent = question.title;
   }
   
   // Mostrar objetivo se existir
   const objectiveElement = document.getElementById('questionObjective');
   if (question.objective) {
       objectiveElement.textContent = question.objective;
       objectiveElement.style.display = 'block';
   } else {
       objectiveElement.style.display = 'none';
   }
   
   // Criar opções de resposta com animação
   const answersContainer = document.getElementById('answersContainer');
   answersContainer.innerHTML = '';
   
   question.answers.forEach((answer, index) => {
       const answerDiv = document.createElement('div');
       answerDiv.className = 'answer-option clickable-button';
       answerDiv.textContent = answer;
       answerDiv.onclick = () => selectAnswer(index);
       answerDiv.style.animationDelay = `${index * 0.1}s`;
       answersContainer.appendChild(answerDiv);
   });
   
   // Resetar seleção
   selectedAnswer = null;
   document.getElementById('nextBtn').classList.remove('active');
   
   // Atualizar texto do botão
   if (currentQuestionIndex === questions.length - 1) {
       document.getElementById('nextBtn').textContent = 'Ver Meu Acesso Gratuito';
   } else {
       document.getElementById('nextBtn').textContent = 'Próxima Pergunta';
   }
}

function selectAnswer(answerIndex) {
   // Remover seleção anterior
   document.querySelectorAll('.answer-option').forEach(option => {
       option.classList.remove('selected');
   });
   
   // Selecionar nova resposta com feedback visual
   const selectedOption = document.querySelectorAll('.answer-option')[answerIndex];
   selectedOption.classList.add('selected');
   selectedAnswer = answerIndex;
   
   // Salvar período selecionado para pergunta 12
   if (currentQuestionIndex === 10) {
       selectedTimePeriod = answerIndex;
   }
   
   // Ativar botão next com animação
   document.getElementById('nextBtn').classList.add('active');
   
   // Track resposta selecionada
   fbq('trackCustom', 'AnswerSelected', {
       question_number: currentQuestionIndex + 1,
       answer_index: answerIndex,
       answer_text: selectedOption.textContent.substring(0, 30)
   });
}

function nextQuestion() {
   if (selectedAnswer === null || isSubmitting) return;
   
   const currentQuestion = questions[currentQuestionIndex];
   
   // Verificar se é resposta de saída (exceto pergunta 13)
   if (currentQuestionIndex !== questions.length - 1 && currentQuestion.exitAnswers && currentQuestion.exitAnswers.includes(selectedAnswer)) {
       showExitScreen(currentQuestion.exitMessage);
       return;
   }
   
   // Se é a última pergunta (13) - Pergunta final
   if (currentQuestionIndex === questions.length - 1) {
       if (selectedAnswer === 0) {
           // "🔥 Chega! Quero mudar isso AGORA"
           showActivationPage('high_intent');
       } else if (selectedAnswer === 1) {
           // "🤔 Quero mudar, mas preciso conhecer melhor esse método"
           showActivationPage('medium_intent');
       } else {
           // "😔 Prefiro deixar pra depois"
           showCompassionSection();
       }
       return;
   }
   
   // Próxima pergunta
   currentQuestionIndex++;
   if (currentQuestionIndex < questions.length) {
       showQuestion();
   }
}

// FUNÇÃO PRINCIPAL DE ATIVAÇÃO GRATUITA
function showActivationPage(intentLevel = 'high_intent') {
   hideAllScreens();
   
   // Definir urgência baseada na intenção
   const urgencyHours = intentLevel === 'high_intent' ? 2 : 4;
   urgencyDeadline = new Date().getTime() + (urgencyHours * 60 * 60 * 1000);
   
   const activationHTML = `
       <div class="activation-page">
           <!-- HEADER PRINCIPAL -->
           <div class="page-header">
               <h1>🎁 SEU ACESSO GRATUITO ESTÁ PRONTO!</h1>
               <p class="subtitle">Comece agora mesmo - sem cartão, sem compromisso</p>
           </div>

           <!-- DESTAQUE DE ACESSO GRATUITO -->
           <div class="free-access-highlight">
               ⚡ 7 DIAS DE AUTOCONHECIMENTO GRATUITO ⚡
           </div>

           <!-- TIMER DE URGÊNCIA -->
           <div class="urgency-timer" id="urgencyTimer">
               <h4>⏰ Acesso liberado por tempo limitado</h4>
               <div class="timer-display" id="timerDisplay">02:00:00</div>
               <p>Comece hoje e veja seus primeiros insights em 24h</p>
           </div>

           <!-- BENEFÍCIOS PRINCIPAIS -->
           <div class="benefit-grid">
               <div class="benefit-card">
                   <span class="icon">📔</span>
                   <h4>Diário de Bordo</h4>
                   <p>Um espaço só seu para desabafar, refletir e transformar seus dias com mais consciência..</p>
               </div>

               <div class="benefit-card">
                   <span class="icon">🧠</span>
                   <h4>Perfil Comportamental</h4>
                   <p>Descubra como você pensa, sente e age. Aprenda a usar isso a seu favor.</p>
               </div>

               <div class="benefit-card">
                   <span class="icon">🧭</span>
                   <h4>Roda da Vida</h4>
                   <p>Veja quais áreas estão desequilibradas e saiba por onde começar a mudança.</p>
               </div>

               <div class="benefit-card">
                   <span class="icon">🛠️</span>
                   <h4>Ferramentas que Evoluem</h4>
                   <p>Recursos simples e poderosos, liberados frequentemente para te ajudar de verdade.</p>
               </div>

               <div class="benefit-card">
                   <span class="icon">🌀</span>
                   <h4>Reflexões Semanais</h4>
                   <p>Mensagens provocadoras que ampliam sua visão e fortalecem sua mente.</p>
               </div>

               <div class="benefit-card">
                   <span class="icon">🌱</span>
                   <h4>Comunidade de Apoio</h4>
                   <p>Troque ideias com quem também está em jornada de crescimento.</p>
               </div>
           </div>

           <!-- CTA PRINCIPAL -->
           <div class="cta-section">
               <h3>🚀 Pronto para começar sua transformação?</h3>
               <p style="font-size: 1.2rem; margin: 20px 0;">Acesso imediato • Sem cartão • Sem compromisso</p>
               
               <a href="https://app.appestoicismo.com.br/" class="cta-main clickable-button" onclick="trackActivation('${intentLevel}')">
                   🎁 COMEÇAR GRÁTIS AGORA
               </a>

               <div class="guarantee-note">
                   <strong>🛡️ E depois?</strong> Você escolhe quando ativar o acesso às trilhas avançadas. Sem pressa. No seu tempo.
               </div>
           </div>

           <!-- PROVA SOCIAL -->
           <div style="text-align: center; margin: 30px 0; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 12px;">
               <p style="font-size: 1.1rem; opacity: 0.9;">
                   <strong>+2.847 pessoas</strong> já começaram sua jornada de autoconhecimento
               </p>
               <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 10px;">
                   "Finalmente entendi por que sempre repetia os mesmos padrões" - Marina, 32 anos
               </p>
           </div>
   `;
   
   document.getElementById('activationScreen').innerHTML = activationHTML;
   document.getElementById('activationScreen').style.display = 'block';
   document.getElementById('activationScreen').classList.add('screen-transition');
   
   // Iniciar timer de urgência
   startUrgencyTimer();
   
   // Track Facebook
   fbq('trackCustom', 'ActivationPageViewed', {
       intent_level: intentLevel,
       funnel_stage: 'free_activation',
       urgency_hours: urgencyHours
   });
   
   smartScrollToTop();
}

// FUNÇÃO DE ACOLHIMENTO EMPÁTICO
function showCompassionSection() {
   hideAllScreens();
   
   const compassionHTML = `
       <div class="compassion-screen">
           <h2>Tudo bem adiar. Mas não se esqueça de você.</h2>
           <p>
               Às vezes a vida aperta. E só de estar aqui, você já deu um passo. 
               <br><br>
               Quando quiser, estarei por aqui pra te ajudar a reencontrar o caminho.
           </p>
           
           <audio controls class="audio-player">
               <source src="https://appestoicismo.github.io/audios-appestoicismo/tempo_de_vida.MP3" type="audio/mpeg">
               Seu navegador não suporta áudio.
           </audio>
           
           <div style="margin: 30px 0;">
               <a href="https://app.appestoicismo.com.br/" class="btn-start clickable-button">
                   🧠 Vou Testar
               </a>
               <br><br>
               <a href="javascript:void(0)" class="btn-secondary clickable-button" onclick="showActivationPage('recovery')">
                   💭 Na verdade, quero saber mais sobre o App
               </a>
           </div>
       </div>
   `;
   
   document.getElementById('compassionScreen').innerHTML = compassionHTML;
   document.getElementById('compassionScreen').style.display = 'block';
   document.getElementById('compassionScreen').classList.add('screen-transition');
   
   // Track Facebook
   fbq('trackCustom', 'CompassionSectionViewed', {
       source: 'quiz_final_question',
       user_decision: 'postponed',
       recovery_opportunity: true
   });
   
   smartScrollToTop();
}

// FUNÇÃO DO TIMER DE URGÊNCIA
function startUrgencyTimer() {
   if (!urgencyDeadline) return;
   
   const timerInterval = setInterval(() => {
       const now = new Date().getTime();
       const timeLeft = urgencyDeadline - now;
       
       if (timeLeft <= 0) {
           clearInterval(timerInterval);
           document.getElementById('timerDisplay').textContent = "00:00:00";
           return;
       }
       
       const hours = Math.floor(timeLeft / (1000 * 60 * 60));
       const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
       const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
       
       const display = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
       
       const timerElement = document.getElementById('timerDisplay');
       if (timerElement) {
           timerElement.textContent = display;
       }
   }, 1000);
}

// FUNÇÃO DE TRACKING DE ATIVAÇÃO
function trackActivation(intentLevel) {
   fbq('track', 'Lead', {
       content_name: 'free_app_access',
       value: 0,
       currency: 'BRL'
   });
   
   fbq('trackCustom', 'FreeActivationClick', {
       intent_level: intentLevel,
       conversion_type: 'free_signup',
       source: 'quiz_completion'
   });
}

// FUNÇÕES DE SAÍDA E REINÍCIO
function showExitScreen(message) {
   stoppedAtQuestion = currentQuestionIndex;
   
   hideAllScreens();
   document.getElementById('exitScreen').style.display = 'block';
   document.getElementById('exitScreen').classList.add('screen-transition');
   
   document.getElementById('exitTitle').textContent = "Entendemos sua posição";
   document.getElementById('exitMessage').textContent = message;
   
   const restartBtn = document.getElementById('restartBtn');
   restartBtn.textContent = `🔄 Continuar da Pergunta ${stoppedAtQuestion + 1}`;
   
   smartScrollToTop();
   
   fbq('trackCustom', 'QuizExit', {
       exit_question: stoppedAtQuestion + 1,
       exit_reason: 'negative_answer'
   });
}

function restartQuiz() {
   if (stoppedAtQuestion > 0) {
       currentQuestionIndex = stoppedAtQuestion;
       selectedAnswer = null;
       
       hideAllScreens();
       document.getElementById('quizScreen').classList.remove('hidden');
       document.getElementById('quizScreen').classList.add('screen-transition');
       
       showQuestion();
       smartScrollToTop();
       
       fbq('trackCustom', 'QuizResumed', {
           resumed_from_question: stoppedAtQuestion + 1
       });
       
       stoppedAtQuestion = 0;
   } else {
       currentQuestionIndex = 0;
       selectedAnswer = null;
       selectedTimePeriod = '';
       
       hideAllScreens();
       document.getElementById('startScreen').classList.remove('hidden');
       document.getElementById('startScreen').classList.add('screen-transition');
       smartScrollToTop();
       
       fbq('trackCustom', 'QuizRestarted', {
           restart_type: 'complete'
       });
   }
}

// FUNÇÕES DE UTILITÁRIO
function smartScrollToTop() {
   // Scroll mais inteligente que foca no conteúdo
   window.scrollTo({ 
       top: 0, 
       behavior: 'smooth' 
   });
   
   // Focus no primeiro elemento interativo visível após scroll
   setTimeout(() => {
       const firstButton = document.querySelector('.clickable-button:not(.hidden)');
       if (firstButton && typeof firstButton.scrollIntoView === 'function') {
           firstButton.scrollIntoView({ 
               behavior: 'smooth', 
               block: 'center',
               inline: 'nearest' 
           });
       }
   }, 600);
}

function hideAllScreens() {
   document.getElementById('startScreen').classList.add('hidden');
   document.getElementById('quizScreen').classList.add('hidden');
   document.getElementById('activationScreen').style.display = 'none';
   document.getElementById('compassionScreen').style.display = 'none';
   document.getElementById('exitScreen').style.display = 'none';
   document.getElementById('loadingScreen').style.display = 'none';
}

// MELHORIAS DE UX E PERFORMANCE
function throttleClicks(func, delay = 300) {
   let lastClickTime = 0;
   return function(...args) {
       const now = Date.now();
       if (now - lastClickTime >= delay) {
           lastClickTime = now;
           return func.apply(this, args);
       }
   };
}

// Aplicar throttling aos botões principais
const originalNextQuestion = nextQuestion;
nextQuestion = throttleClicks(originalNextQuestion, 500);

const originalStartQuiz = startQuiz;
startQuiz = throttleClicks(originalStartQuiz, 1000);

// EVENTOS DE INTERAÇÃO MELHORADOS
document.addEventListener('DOMContentLoaded', function() {
   // Feedback visual melhorado para mobile
   document.addEventListener('touchstart', function(e) {
       if (e.target.classList.contains('clickable-button')) {
           e.target.style.transform = 'scale(0.98)';
       }
   });

   document.addEventListener('touchend', function(e) {
       if (e.target.classList.contains('clickable-button')) {
           setTimeout(() => {
               e.target.style.transform = '';
           }, 150);
       }
   });

   // Keyboard navigation
   document.addEventListener('keydown', function(e) {
       if (e.key === 'Enter' && selectedAnswer !== null) {
           const nextBtn = document.getElementById('nextBtn');
           if (nextBtn && nextBtn.classList.contains('active')) {
               nextQuestion();
           }
       }
       
       if (e.key >= '1' && e.key <= '9') {
           const answerIndex = parseInt(e.key) - 1;
           const options = document.querySelectorAll('.answer-option');
           if (options[answerIndex]) {
               selectAnswer(answerIndex);
           }
       }
   });

   // Exit intent tracking
   let hasInteracted = false;
   
   document.addEventListener('click', () => hasInteracted = true);
   document.addEventListener('keydown', () => hasInteracted = true);
   
   document.addEventListener('mouseout', function(e) {
       if (e.clientY <= 0 && hasInteracted) {
           fbq('trackCustom', 'ExitIntent', {
               current_question: currentQuestionIndex + 1,
               funnel_stage: getCurrentScreen()
           });
       }
   });

   // Tracking de tempo na página
   let startTime = Date.now();
   
   window.addEventListener('beforeunload', function() {
       const timeSpent = Math.round((Date.now() - startTime) / 1000);
       fbq('trackCustom', 'TimeSpent', {
           seconds: timeSpent,
           questions_answered: currentQuestionIndex,
           funnel_completion: getCurrentScreen() === 'activation' ? 'completed' : 'incomplete'
       });
   });

   // Acessibilidade melhorada
   const buttons = document.querySelectorAll('button, .clickable-button');
   buttons.forEach(button => {
       if (!button.getAttribute('aria-label')) {
           button.setAttribute('aria-label', button.textContent.trim());
       }
   });

   // Respeitar preferências do usuário
   if (window.matchMedia && window.matchMedia('(prefers-contrast: high)').matches) {
       document.body.style.setProperty('--cor-destaque', '#00ff00');
       document.body.style.setProperty('--cor-principal', '#000000');
   }

   if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
       document.head.insertAdjacentHTML('beforeend', `
           <style>
               *, *::before, *::after {
                   animation-duration: 0.01ms !important;
                   animation-iteration-count: 1 !important;
                   transition-duration: 0.01ms !important;
               }
           </style>
       `);
   }
});

function getCurrentScreen() {
   if (!document.getElementById('startScreen').classList.contains('hidden')) return 'start';
   if (!document.getElementById('quizScreen').classList.contains('hidden')) return 'quiz';
   if (document.getElementById('activationScreen').style.display !== 'none') return 'activation';
   if (document.getElementById('compassionScreen').style.display !== 'none') return 'compassion';
   if (document.getElementById('exitScreen').style.display !== 'none') return 'exit';
   if (document.getElementById('loadingScreen').style.display !== 'none') return 'loading';
   return 'unknown';
}

// Analytics avançados
function trackAdvancedMetrics() {
   if (window.performance) {
       const navigation = performance.getEntriesByType('navigation')[0];
       fbq('trackCustom', 'PagePerformance', {
           load_time: Math.round(navigation.loadEventEnd - navigation.loadEventStart),
           dom_ready: Math.round(navigation.domContentLoadedEventEnd - navigation.domContentLoadedEventStart)
       });
   }
   
   fbq('trackCustom', 'DeviceInfo', {
       screen_width: window.screen.width,
       screen_height: window.screen.height,
       viewport_width: window.innerWidth,
       viewport_height: window.innerHeight,
       device_pixel_ratio: window.devicePixelRatio || 1,
       is_mobile: window.innerWidth <= 768,
       user_agent: navigator.userAgent.substring(0, 100)
   });
}

window.addEventListener('load', trackAdvancedMetrics);

// Error boundary
window.addEventListener('error', function(e) {
   console.error('JavaScript Error:', e.error);
   fbq('trackCustom', 'JavaScriptError', {
       message: e.message.substring(0, 100),
       filename: e.filename,
       lineno: e.lineno,
       current_screen: getCurrentScreen()
   });
});

// Debug mode para desenvolvimento
if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
   console.log('🎯 Quiz AppAutoconhecimento v5.0 - Foco em Ativação Gratuita');
   console.log('📊 Debug mode ativo');
   
   window.debugQuiz = {
       jumpToQuestion: (n) => {
           currentQuestionIndex = n - 1;
           showQuestion();
       },
       testActivationPage: (intent = 'high_intent') => {
           showActivationPage(intent);
       },
       testCompassionSection: () => {
           showCompassionSection();
       },
       simulateTimer: () => {
           urgencyDeadline = new Date().getTime() + (5 * 60 * 1000); // 5 minutes
           startUrgencyTimer();
       },
       showAllScreens: () => {
           console.log('Telas disponíveis:');
           console.log('1. debugQuiz.testActivationPage() - Página de ativação');
           console.log('2. debugQuiz.testCompassionSection() - Tela de acolhimento');
           console.log('3. debugQuiz.simulateTimer() - Testar timer de urgência');
       }
   };
}

   </script>
</body>
</html>
